
image: node:12.18.4

services:
    - docker:dind

stages:
    - build
    - deploy
  
build:
    stage: build
    script:
        - npm install
        - docker restart gitlab-runner
        - ./scripts/build.sh

    artifacts:
        paths:
            - ./build/app-.zip

deploy:
    stage: deploy
    cache:
        key: ${CI_COMMIT_REF_SLUG}
        paths:
            - node_modules/
    image: emiketic/essentials
    script:
        - ./scripts/deploy.sh 
